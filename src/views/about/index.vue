<script setup lang="ts">
import { NCard, NSplit, NButton, NScrollbar, NTag } from 'naive-ui'
import { ref, watch } from 'vue'

import packageJson from '@/../package.json'
import { usePersonalization } from '@/composable/usePersonalization'

defineOptions({
  name: 'About',
})

let codeToHtml: any

const APP_NAME = import.meta.env.VITE_APP_NAME

const { isDark } = usePersonalization()

const { dependencies, devDependencies } = packageJson

const directoryStructureHighlight = ref('')
const dependenciesCodeHighlight = ref('')
const devDependenciesCodeHighlight = ref('')

const dir = `ğŸ“‚ lithe-admin
â”œâ”€â”€ ğŸ“„ LICENSE
â”œâ”€â”€ ğŸ“„ README.md
â”œâ”€â”€ ğŸ“„ eslint.config.ts
â”œâ”€â”€ ğŸ“„ index.html
â”œâ”€â”€ ğŸ“„ package.json
â”œâ”€â”€ ğŸ“„ pnpm-lock.yaml
â””â”€â”€ ğŸ“‚ public/
â”‚  â””â”€â”€ ğŸ“‚ assets/
â”‚    â”œâ”€â”€ ğŸ“„ preloader.css
â”‚  â”œâ”€â”€ ğŸ“„ favicon.ico
â””â”€â”€ ğŸ“‚ src/
â”‚  â”œâ”€â”€ ğŸ“„ App.vue
â”‚  â””â”€â”€ ğŸ“‚ assets/
â”‚    â”œâ”€â”€ ğŸ“„ base.css
â”‚    â”œâ”€â”€ ğŸ“„ main.css
â”‚    â”œâ”€â”€ ğŸ“„ noise.png
â”‚    â”œâ”€â”€ ğŸ“„ texture.png
â”‚    â”œâ”€â”€ ğŸ“„ topography.svg
â”‚  â””â”€â”€ ğŸ“‚ components/
â”‚    â”œâ”€â”€ ğŸ“„ Avatar.vue
â”‚    â”œâ”€â”€ ğŸ“„ ButtonAnimation.vue
â”‚    â”œâ”€â”€ ğŸ“„ EmptyPlaceholder.vue
â”‚    â”œâ”€â”€ ğŸ“„ HintHelp.vue
â”‚    â”œâ”€â”€ ğŸ“„ Noise.vue
â”‚    â””â”€â”€ ğŸ“‚ __tests__/
â”‚      â”œâ”€â”€ ğŸ“„ comp.test.ts
â”‚    â”œâ”€â”€ ğŸ“„ index.ts
â”‚  â””â”€â”€ ğŸ“‚ composable/
â”‚    â”œâ”€â”€ ğŸ“„ useComponentModifier.ts
â”‚    â”œâ”€â”€ ğŸ“„ useComponentThemeOverrides.ts
â”‚    â”œâ”€â”€ ğŸ“„ useDataTable.ts
â”‚    â”œâ”€â”€ ğŸ“„ useDiscreteApi.ts
â”‚    â”œâ”€â”€ ğŸ“„ usePersonalization.ts
â”‚    â”œâ”€â”€ ğŸ“„ useResettable.ts
â”‚    â”œâ”€â”€ ğŸ“„ useTheme.ts
â”‚  â””â”€â”€ ğŸ“‚ layouts/
â”‚    â””â”€â”€ ğŸ“‚ aside/
â”‚      â””â”€â”€ ğŸ“‚ component/
â”‚        â”œâ”€â”€ ğŸ“„ Menu.vue
â”‚        â”œâ”€â”€ ğŸ“„ UserCard.vue
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â””â”€â”€ ğŸ“‚ component/
â”‚      â”œâ”€â”€ ğŸ“„ Tabs.vue
â”‚    â””â”€â”€ ğŸ“‚ footer/
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â””â”€â”€ ğŸ“‚ header/
â”‚      â””â”€â”€ ğŸ“‚ Actions/
â”‚        â””â”€â”€ ğŸ“‚ component/
â”‚          â”œâ”€â”€ ğŸ“„ FullScreen.vue
â”‚          â”œâ”€â”€ ğŸ“„ NoiseModal.vue
â”‚          â”œâ”€â”€ ğŸ“„ PreferencesDrawer.vue
â”‚          â”œâ”€â”€ ğŸ“„ SignOut.vue
â”‚          â”œâ”€â”€ ğŸ“„ ThemeDropdown.vue
â”‚          â”œâ”€â”€ ğŸ“„ WatermarkModal.vue
â”‚        â”œâ”€â”€ ğŸ“„ index.vue
â”‚      â”œâ”€â”€ ğŸ“„ Breadcrumb.vue
â”‚      â”œâ”€â”€ ğŸ“„ Logo.vue
â”‚      â”œâ”€â”€ ğŸ“„ Navigation.vue
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â””â”€â”€ ğŸ“‚ main/
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”‚  â”œâ”€â”€ ğŸ“„ main.ts
â”‚  â””â”€â”€ ğŸ“‚ router/
â”‚    â”œâ”€â”€ ğŸ“„ guard.ts
â”‚    â”œâ”€â”€ ğŸ“„ helper.ts
â”‚    â”œâ”€â”€ ğŸ“„ index.ts
â”‚    â”œâ”€â”€ ğŸ“„ record.ts
â”‚  â””â”€â”€ ğŸ“‚ stores/
â”‚    â”œâ”€â”€ ğŸ“„ preferences.ts
â”‚    â”œâ”€â”€ ğŸ“„ system.ts
â”‚    â”œâ”€â”€ ğŸ“„ tabs.ts
â”‚    â”œâ”€â”€ ğŸ“„ user.ts
â”‚  â””â”€â”€ ğŸ“‚ theme/
â”‚    â”œâ”€â”€ ğŸ“„ common.ts
â”‚    â”œâ”€â”€ ğŸ“„ dark.ts
â”‚    â”œâ”€â”€ ğŸ“„ light.ts
â”‚  â””â”€â”€ ğŸ“‚ typings/
â”‚    â”œâ”€â”€ ğŸ“„ env.d.ts
â”‚    â”œâ”€â”€ ğŸ“„ vue-router.d.ts
â”‚    â”œâ”€â”€ ğŸ“„ window.d.ts
â”‚  â””â”€â”€ ğŸ“‚ utils/
â”‚    â”œâ”€â”€ ğŸ“„ tailwindColor.test.ts
â”‚    â”œâ”€â”€ ğŸ“„ tailwindColor.ts
â”‚  â””â”€â”€ ğŸ“‚ views/
â”‚    â””â”€â”€ ğŸ“‚ about/
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â””â”€â”€ ğŸ“‚ dashboard/
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â””â”€â”€ ğŸ“‚ data-show/
â”‚      â””â”€â”€ ğŸ“‚ data-form/
â”‚        â”œâ”€â”€ ğŸ“„ index.vue
â”‚      â””â”€â”€ ğŸ“‚ data-table/
â”‚        â”œâ”€â”€ ğŸ“„ ModalData.vue
â”‚        â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â””â”€â”€ ğŸ“‚ drag-drop/
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â””â”€â”€ ğŸ“‚ dynamic-route/
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â””â”€â”€ ğŸ“‚ error-page/
â”‚      â”œâ”€â”€ ğŸ“„ 404.vue
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â””â”€â”€ ğŸ“‚ feedback/
â”‚      â”œâ”€â”€ ğŸ“„ discreteApi.ts
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â””â”€â”€ ğŸ“‚ multi-level-menu/
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”‚    â””â”€â”€ ğŸ“‚ sign-in/
â”‚      â””â”€â”€ ğŸ“‚ component/
â”‚        â”œâ”€â”€ ğŸ“„ Illustration1.vue
â”‚        â”œâ”€â”€ ğŸ“„ Illustration2.vue
â”‚        â”œâ”€â”€ ğŸ“„ Illustration3.vue
â”‚        â”œâ”€â”€ ğŸ“„ Illustration4.vue
â”‚        â”œâ”€â”€ ğŸ“„ ThemeColorPopover.vue
â”‚      â”œâ”€â”€ ğŸ“„ index.vue
â”œâ”€â”€ ğŸ“„ tailwind.config.ts
â”œâ”€â”€ ğŸ“„ tsconfig.app.json
â”œâ”€â”€ ğŸ“„ tsconfig.json
â”œâ”€â”€ ğŸ“„ tsconfig.node.json
â”œâ”€â”€ ğŸ“„ tsconfig.vitest.json
â”œâ”€â”€ ğŸ“„ vercel.json
â”œâ”€â”€ ğŸ“„ vite.config.ts
â””â”€â”€ ğŸ“„ vitest.config.ts`

watch(
  isDark,
  async () => {
    if (!codeToHtml) {
      // @ts-ignore
      const shiki = await import('https://cdn.jsdelivr.net/npm/shiki@3.7.0/+esm')
      codeToHtml = shiki.codeToHtml
    }

    const theme = isDark.value ? 'dark-plus' : 'min-light'

    codeToHtml(dir, { lang: 'markdown', theme })
      .then((result: string) => (directoryStructureHighlight.value = result))
      .catch(() => (directoryStructureHighlight.value = dir))

    codeToHtml(JSON.stringify(dependencies, null, 2), { lang: 'json', theme })
      .then((result: string) => (dependenciesCodeHighlight.value = result))
      .catch(() => (dependenciesCodeHighlight.value = JSON.stringify(dependencies, null, 2)))

    codeToHtml(JSON.stringify(devDependencies, null, 2), { lang: 'json', theme })
      .then((result: string) => (devDependenciesCodeHighlight.value = result))
      .catch(() => (devDependenciesCodeHighlight.value = JSON.stringify(devDependencies, null, 2)))
  },
  { immediate: true },
)
</script>
<template>
  <div class="flex flex-col gap-y-4 p-4">
    <NCard :title="`å…³äº ${APP_NAME}`">
      <p class="text-base">
        {{ APP_NAME }} æ˜¯ä¸€ä¸ªè½»ç›ˆè€Œä¼˜é›…çš„åå°ç®¡ç†æ¨¡æ¿ï¼Œä¸»è¦æŠ€æœ¯æ ˆç”±
        <a
          href="https://vuejs.org/"
          target="_blank"
        >
          <NButton
            strong
            secondary
            size="small"
            color="#42b883"
          >
            Vue3
          </NButton>
        </a>
        <a
          href="https://www.naiveui.com/"
          target="_blank"
        >
          <NButton
            strong
            secondary
            color="#75B93F"
            size="small"
            style="margin-left: 4px"
          >
            Naive UI
          </NButton>
        </a>
        <a
          href="https://vitejs.dev/"
          target="_blank"
        >
          <NButton
            strong
            secondary
            color="#9499ff"
            size="small"
            style="margin-left: 4px"
          >
            Vite7
          </NButton>
        </a>
        <a
          href="https://tailwindcss.com/"
          target="_blank"
        >
          <NButton
            strong
            secondary
            color="#00bcff"
            size="small"
            class="ml-1!"
          >
            TailwindCSS4
          </NButton>
        </a>
        å’Œ
        <NButton
          strong
          secondary
          size="small"
        >
          TypeScript
        </NButton>
        æ„å»ºã€‚
      </p>
    </NCard>
    <div class="flex gap-x-2">
      <NCard title="ç›®å½•ç»“æ„">
        <NScrollbar container-style="max-height: 1100px;">
          <div v-html="directoryStructureHighlight"></div>
        </NScrollbar>
      </NCard>
      <NCard title="ä¾èµ–ä¿¡æ¯">
        <NSplit
          direction="vertical"
          pane1-class="pb-4"
          pane2-class="pt-4"
          default-size="2"
        >
          <template #1>
            <NTag
              class="mb-4"
              :bordered="false"
              type="info"
              size="small"
              >dependencies</NTag
            >
            <NScrollbar>
              <div v-html="dependenciesCodeHighlight"></div>
            </NScrollbar>
          </template>

          <template #2>
            <NTag
              class="mb-4"
              :bordered="false"
              type="info"
              size="small"
              >devDependencies</NTag
            >
            <NScrollbar>
              <div v-html="devDependenciesCodeHighlight"></div>
            </NScrollbar>
          </template>
          <template #resize-trigger>
            <div class="h-px w-full cursor-col-resize bg-neutral-200 dark:bg-neutral-700"></div>
          </template>
        </NSplit>
      </NCard>
    </div>
  </div>
</template>
